(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aa450304"],{"1dde":function(e,t,o){var n=o("d039"),l=o("b622"),a=o("2d00"),r=l("species");e.exports=function(e){return a>=51||!n((function(){var t=[],o=t.constructor={};return o[r]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"2e43":function(e,t,o){"use strict";o.r(t);o("b0c0");var n=o("7a23"),l=Object(n["l"])("新建销售单"),a={class:"dialog-footer"},r=Object(n["l"])("取 消"),u=Object(n["l"])("确 定"),i=Object(n["l"])("添加商品");function c(e,t,o,c,d,b){var s=Object(n["M"])("el-button"),p=Object(n["M"])("el-button-group"),m=Object(n["M"])("el-table-column"),f=Object(n["M"])("el-table"),O=Object(n["M"])("el-pagination"),j=Object(n["M"])("el-input"),g=Object(n["M"])("el-form-item"),h=Object(n["M"])("el-option"),y=Object(n["M"])("el-select"),w=Object(n["M"])("el-switch"),V=Object(n["M"])("el-form"),k=Object(n["M"])("el-dialog"),T=Object(n["M"])("el-main"),v=Object(n["N"])("loading");return Object(n["D"])(),Object(n["i"])("div",null,[Object(n["m"])(T,null,{default:Object(n["ab"])((function(){return[Object(n["m"])(p,{style:{"margin-bottom":"10px","margin-top":"10px"}},{default:Object(n["ab"])((function(){return[Object(n["m"])(s,{onClick:t[1]||(t[1]=function(t){return e.dialogFormVisible=!0}),type:"primary",plain:"",icon:"el-icon-plus"},{default:Object(n["ab"])((function(){return[l]})),_:1})]})),_:1}),Object(n["bb"])(Object(n["m"])(f,{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)",data:e.tableDataList,style:{width:"100%"},"row-style":{height:"40px"},"cell-style":{padding:"5px 0"},stripe:"",border:"","highlight-current-row":""},{default:Object(n["ab"])((function(){return[Object(n["m"])(m,{type:"expand"},{default:Object(n["ab"])((function(e){return[Object(n["m"])(f,{data:e.row.stockOutDetailList,style:{width:"100%"},"row-style":{height:"40px"},"cell-style":{padding:"5px 0"},stripe:"",border:"","highlight-current-row":""},{default:Object(n["ab"])((function(){return[Object(n["m"])(m,{prop:"stockOutId",label:"销售单号"}),Object(n["m"])(m,{prop:"goodsTypeName",label:"商品类型"}),Object(n["m"])(m,{prop:"goodsName",label:"商品名称"}),Object(n["m"])(m,{prop:"amount",label:"销售数量"}),Object(n["m"])(m,{prop:"goodsUnit",label:"单位"}),Object(n["m"])(m,{label:"销售单价（￥）"},{default:Object(n["ab"])((function(e){return[Object(n["l"])(Object(n["Q"])(e.row.price)+" 元 ",1)]})),_:2},1024),Object(n["m"])(m,{label:"销售总价（￥）"},{default:Object(n["ab"])((function(e){return[Object(n["l"])(Object(n["Q"])(e.row.totalPrice)+" 元 ",1)]})),_:2},1024)]})),_:2},1032,["data"])]})),_:1}),Object(n["m"])(m,{prop:"id",label:"销售单号"}),Object(n["m"])(m,{prop:"mobileTelephone",label:"会员电话"}),Object(n["m"])(m,{label:"销售总价（￥）"},{default:Object(n["ab"])((function(e){return[Object(n["l"])(Object(n["Q"])(e.row.totalPrice)+" 元 ",1)]})),_:1}),Object(n["m"])(m,{prop:"remark",label:"备注信息"}),Object(n["m"])(m,{prop:"createTime",label:"创建时间",formatter:b.dateTimeFormat},null,8,["formatter"]),Object(n["m"])(m,{prop:"updateTime",label:"更新时间",formatter:b.dateTimeFormat},null,8,["formatter"]),Object(n["m"])(m,{prop:"createBy",label:"创建者"}),Object(n["m"])(m,{prop:"updateBy",label:"修改者"})]})),_:1},8,["data"]),[[v,e.loading]]),Object(n["m"])(O,{background:"",onSizeChange:b.handleSizeChange,onCurrentChange:b.handleCurrentChange,"current-page":e.currentPage,"page-sizes":[15,30,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"]),Object(n["m"])(k,{title:"销售单明细",modelValue:e.dialogFormVisible,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.dialogFormVisible=t})},{footer:Object(n["ab"])((function(){return[Object(n["m"])("span",a,[Object(n["m"])(s,{onClick:t[5]||(t[5]=function(e){return b.closeDialog()})},{default:Object(n["ab"])((function(){return[r]})),_:1}),Object(n["m"])(s,{type:"primary",onClick:t[6]||(t[6]=function(e){return b.addStockOut("form")})},{default:Object(n["ab"])((function(){return[u]})),_:1}),Object(n["m"])(s,{onClick:t[7]||(t[7]=function(e){return b.addRow()}),type:"primary",plain:"",icon:"el-icon-plus"},{default:Object(n["ab"])((function(){return[i]})),_:1})])]})),default:Object(n["ab"])((function(){return[Object(n["m"])(V,{model:e.form,rules:e.rules,ref:"form","label-width":"20px"},{default:Object(n["ab"])((function(){return[Object(n["m"])(g,{label:"会员电话","label-width":"100px"},{default:Object(n["ab"])((function(){return[Object(n["m"])(j,{type:"text",modelValue:e.form.mobileTelephone,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.form.mobileTelephone=t})},null,8,["modelValue"])]})),_:1}),Object(n["m"])(g,{label:"备注","label-width":"100px"},{default:Object(n["ab"])((function(){return[Object(n["m"])(j,{type:"textarea",modelValue:e.form.remark,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.form.remark=t})},null,8,["modelValue"])]})),_:1}),Object(n["m"])(f,{data:e.form.stockOutDetailList,border:"",stripe:""},{default:Object(n["ab"])((function(){return[Object(n["m"])(m,{label:"商品类型",width:"180px;"},{default:Object(n["ab"])((function(t){return[t&&t.$index>=0?(Object(n["D"])(),Object(n["i"])(g,{key:0,label:" ",prop:"stockOutDetailList."+t.$index+".goodsTypeId",rules:e.rules.goodsTypeId},{default:Object(n["ab"])((function(){return[Object(n["m"])(y,{modelValue:t.row.goodsTypeId,"onUpdate:modelValue":function(e){return t.row.goodsTypeId=e},key:t.row.goodsTypeId,placeholder:"请选择商品类型",onChange:function(e){return b.loadGoodsByGoodsTypeId(t.row.goodsTypeId,t.row)}},{default:Object(n["ab"])((function(){return[(Object(n["D"])(!0),Object(n["i"])(n["b"],null,Object(n["K"])(e.goodsTypeList,(function(e){return Object(n["D"])(),Object(n["i"])(h,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])})),128))]})),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]})),_:2},1032,["prop","rules"])):Object(n["j"])("",!0)]})),_:1}),Object(n["m"])(m,{label:"商品名称",width:"180px;"},{default:Object(n["ab"])((function(t){return[t&&t.$index>=0?(Object(n["D"])(),Object(n["i"])(g,{key:0,label:" ",prop:"stockOutDetailList."+t.$index+".goodsId",rules:e.rules.goodsId},{default:Object(n["ab"])((function(){return[Object(n["m"])(y,{modelValue:t.row.goodsId,"onUpdate:modelValue":function(e){return t.row.goodsId=e},key:t.row.goodsId,placeholder:"请选择商品",onChange:function(e){return b.setGoodsPriceAndUnitAndTotalPrice(t.row.goodsId,t.row)}},{default:Object(n["ab"])((function(){return[(Object(n["D"])(!0),Object(n["i"])(n["b"],null,Object(n["K"])(t.row.goodsList,(function(e){return Object(n["D"])(),Object(n["i"])(h,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])})),128))]})),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]})),_:2},1032,["prop","rules"])):Object(n["j"])("",!0)]})),_:1}),Object(n["m"])(m,{label:"单价（￥）",width:"160px;"},{default:Object(n["ab"])((function(t){return[t&&t.$index>=0?(Object(n["D"])(),Object(n["i"])(g,{key:0,label:" ",prop:"stockOutDetailList."+t.$index+".price",rules:e.rules.price},{default:Object(n["ab"])((function(){return[Object(n["m"])(j,{type:"number",modelValue:t.row.price,"onUpdate:modelValue":function(e){return t.row.price=e},placeholder:"请输入价格",onInput:function(e){return b.computeTotalPrice(t.row)}},null,8,["modelValue","onUpdate:modelValue","onInput"])]})),_:2},1032,["prop","rules"])):Object(n["j"])("",!0)]})),_:1}),Object(n["m"])(m,{label:"数量"},{default:Object(n["ab"])((function(t){return[t&&t.$index>=0?(Object(n["D"])(),Object(n["i"])(g,{key:0,label:" ",prop:"stockOutDetailList."+t.$index+".amount",rules:e.rules.amount},{default:Object(n["ab"])((function(){return[Object(n["m"])(j,{type:"number",modelValue:t.row.amount,"onUpdate:modelValue":function(e){return t.row.amount=e},placeholder:"请输入数量",onInput:function(e){return b.computeTotalPrice(t.row)}},null,8,["modelValue","onUpdate:modelValue","onInput"])]})),_:2},1032,["prop","rules"])):Object(n["j"])("",!0)]})),_:1}),Object(n["m"])(m,{label:"单位"},{default:Object(n["ab"])((function(e){return[Object(n["m"])(g,{label:" "},{default:Object(n["ab"])((function(){return[Object(n["m"])(j,{modelValue:e.row.unit,"onUpdate:modelValue":function(t){return e.row.unit=t},disabled:!0},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1024)]})),_:1}),Object(n["m"])(m,{label:"价格合计"},{default:Object(n["ab"])((function(e){return[Object(n["m"])(g,{label:" "},{default:Object(n["ab"])((function(){return[Object(n["m"])(j,{modelValue:e.row.totalPrice,"onUpdate:modelValue":function(t){return e.row.totalPrice=t},disabled:!0},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1024)]})),_:1}),Object(n["m"])(m,{label:"操作",width:"90px;"},{default:Object(n["ab"])((function(e){return[Object(n["m"])(g,{label:" "},{default:Object(n["ab"])((function(){return[Object(n["m"])(s,{onClick:Object(n["db"])((function(t){return b.deleteRow(e.$index)}),["prevent"]),type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},null,8,["onClick"])]})),_:2},1024)]})),_:1})]})),_:1},8,["data"]),Object(n["m"])(g,{label:"已付款","label-width":"100px"},{default:Object(n["ab"])((function(){return[Object(n["m"])(w,{modelValue:e.form.paid,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.form.paid=t}),"active-color":"#13ce66","inactive-color":"#ff4949"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["modelValue"])]})),_:1})])}o("a434");var d={name:"StockIn",data:function(){return{loading:!0,goodsTypeList:[],tableDataList:[],currentPage:1,pageSize:15,total:0,dialogFormVisible:!1,form:{paid:!1,mobileTelephone:null,remark:null,stockOutDetailList:[{goodsTypeId:null,goodsId:null,amount:1,unit:null,price:null}]},rules:{goodsTypeId:[{required:!0,message:"请选择商品类型",trigger:"change"}],goodsId:[{required:!0,message:"请选择商品",trigger:"change"}],amount:[{required:!0,message:"请输入数量",trigger:"blur"}],price:[{required:!0,message:"请输入单价",trigger:"blur"}]}}},methods:{loadTableData:function(e,t){var o=this;this.$http.get("/stock-out/details",{current:e,size:t}).then((function(e){o.tableDataList=e.dataList,o.total=e.total,o.loading=!1}))},loadGoodsTypeData:function(){var e=this;this.$http.get("/goods-type/all").then((function(t){e.goodsTypeList=t}))},loadGoodsByGoodsTypeId:function(e,t){this.$http.get("/goods/type/"+e).then((function(e){t.goodsId=null,t.goodsList=e}))},setGoodsPriceAndUnitAndTotalPrice:function(e,t){var o=this;this.$http.get("/goods/"+e).then((function(e){t.price=e.price,t.unit=e.unit,o.computeTotalPrice(t)}))},computeTotalPrice:function(e){e.totalPrice=e.price*e.amount},handleSizeChange:function(e){this.currentPage=1,this.pageSize=e,this.loadTableData(this.currentPage,this.pageSize)},handleCurrentChange:function(e){this.currentPage=e,this.loadTableData(this.currentPage,this.pageSize)},addRow:function(){this.form.stockOutDetailList.push({goodsTypeId:null,goodsId:null,amount:1,unit:null,price:null})},deleteRow:function(e){this.form.stockOutDetailList.splice(e,1)},addStockOut:function(e){var t=this,o=this;this.$refs[e].validate((function(e){return!!e&&(o.form.paid?void t.$http.post("/stock-out/details",t.form).then((function(){o.closeDialog(),o.loadTableData(o.currentPage,o.pageSize),o.$message({type:"success",message:"操作成功!"})})):(o.$message({type:"warning",message:"未付款! 如果已经付款，请打开已付款开关！"}),!1))}))},closeDialog:function(){this.dialogFormVisible=!1,this.form.stockOutDetailList=[{}]},dateTimeFormat:function(e,t){var o=e[t.property];return void 0==o?"":this.$dayjs(o).format("YYYY-MM-DD HH:mm:ss")}},created:function(){this.loadTableData(this.currentPage,this.pageSize),this.loadGoodsTypeData()}};d.render=c;t["default"]=d},"65f0":function(e,t,o){var n=o("861d"),l=o("e8b5"),a=o("b622"),r=a("species");e.exports=function(e,t){var o;return l(e)&&(o=e.constructor,"function"!=typeof o||o!==Array&&!l(o.prototype)?n(o)&&(o=o[r],null===o&&(o=void 0)):o=void 0),new(void 0===o?Array:o)(0===t?0:t)}},8418:function(e,t,o){"use strict";var n=o("c04e"),l=o("9bf2"),a=o("5c6c");e.exports=function(e,t,o){var r=n(t);r in e?l.f(e,r,a(0,o)):e[r]=o}},a434:function(e,t,o){"use strict";var n=o("23e7"),l=o("23cb"),a=o("a691"),r=o("50c4"),u=o("7b0b"),i=o("65f0"),c=o("8418"),d=o("1dde"),b=o("ae40"),s=d("splice"),p=b("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,f=Math.min,O=9007199254740991,j="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!s||!p},{splice:function(e,t){var o,n,d,b,s,p,g=u(this),h=r(g.length),y=l(e,h),w=arguments.length;if(0===w?o=n=0:1===w?(o=0,n=h-y):(o=w-2,n=f(m(a(t),0),h-y)),h+o-n>O)throw TypeError(j);for(d=i(g,n),b=0;b<n;b++)s=y+b,s in g&&c(d,b,g[s]);if(d.length=n,o<n){for(b=y;b<h-n;b++)s=b+n,p=b+o,s in g?g[p]=g[s]:delete g[p];for(b=h;b>h-n+o;b--)delete g[b-1]}else if(o>n)for(b=h-n;b>y;b--)s=b+n-1,p=b+o-1,s in g?g[p]=g[s]:delete g[p];for(b=0;b<o;b++)g[b+y]=arguments[b+2];return g.length=h-n+o,d}})},ae40:function(e,t,o){var n=o("83ab"),l=o("d039"),a=o("5135"),r=Object.defineProperty,u={},i=function(e){throw e};e.exports=function(e,t){if(a(u,e))return u[e];t||(t={});var o=[][e],c=!!a(t,"ACCESSORS")&&t.ACCESSORS,d=a(t,0)?t[0]:i,b=a(t,1)?t[1]:void 0;return u[e]=!!o&&!l((function(){if(c&&!n)return!0;var e={length:-1};c?r(e,1,{enumerable:!0,get:i}):e[1]=1,o.call(e,d,b)}))}},b0c0:function(e,t,o){var n=o("83ab"),l=o("9bf2").f,a=Function.prototype,r=a.toString,u=/^\s*function ([^ (]*)/,i="name";n&&!(i in a)&&l(a,i,{configurable:!0,get:function(){try{return r.call(this).match(u)[1]}catch(e){return""}}})},e8b5:function(e,t,o){var n=o("c6b6");e.exports=Array.isArray||function(e){return"Array"==n(e)}}}]);
//# sourceMappingURL=chunk-aa450304.ff69fb5f.js.map